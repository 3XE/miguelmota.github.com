<!DOCTYPE html>
<html lang="en-US" manifest="http://cache.miguelmota.com/cache.appcache">
<head>
	<meta charset="UTF-8">
	<!--
	                                      ___                           __
	           __                        /\_ \                         /\ \__
	  ___ ___ /\_\     __   __  __     __\//\ \         ___ ___     ___\ \ ,_\    __
	/' __` __`\/\ \  /'_ `\/\ \/\ \  /'__`\\ \ \      /' __` __`\  / __`\ \ \/  /'__`\
	/\ \/\ \/\ \ \ \/\ \L\ \ \ \_\ \/\  __/ \_\ \_    /\ \/\ \/\ \/\ \L\ \ \ \_/\ \L\.\_
	\ \_\ \_\ \_\ \_\ \____ \ \____/\ \____\/\____\   \ \_\ \_\ \_\ \____/\ \__\ \__/.\_\
	 \/_/\/_/\/_/\/_/\/___L\ \/___/  \/____/\/____/    \/_/\/_/\/_/\/___/  \/__/\/__/\/_/
	                   /\____/
	                   \_/__/
	-->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="description" content="Setting up git hooks for effortless deployment.">
	<meta name="keywords" content="miguel mota,web developer,html5 css3 javascript">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-title" content="Moogs">
	<title>Deployment with Git » Miguel Mota | Web Developer</title>
	<link rel="canonical" href="http://www.miguelmota.com/blog/deployment-with-git">
	<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/miguelmota">
	<link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144x144.png">
	<link rel="apple-touch-startup-image" media="(device-width: 320px)" href="/img/apple-touch-startup-image-320x460.png">
	<link rel="apple-touch-startup-image" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" href="/img/apple-touch-startup-image-640x920.png">
	<link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="/img/apple-touch-startup-image-640x1096.png">
	<link rel="apple-touch-startup-image" media="(device-width: 768px) and (orientation: portrait)" href="/img/apple-touch-startup-image-768x1004.png">
	<link rel="apple-touch-startup-image" media="(device-width: 768px) and (orientation: landscape)" href="/img/apple-touch-startup-image-748x1024.png">
	<link rel="apple-touch-startup-image" media="(device-width: 1536px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" href="/img/apple-touch-startup-image-1536x2008.png">
	<link rel="apple-touch-startup-image" media="(device-width: 1536px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" href="/img/apple-touch-startup-image-2048x1496.png">
	<link rel="stylesheet" href="/css/main.css">
	<script src="//use.typekit.net/wkl5rpy.js"></script>
	<script>try{Typekit.load();}catch(e){}</script>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  <script src="/js/main.min.js"></script>
	<script>
	  	var _gaq = _gaq || [];
	   	_gaq.push(['_setAccount', 'UA-12642068-1']);
	   	_gaq.push(['_setDomainName', '.miguelmota.com']);
	  	_gaq.push(['_trackPageview']);
	   	(function() {
	     		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	     		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	     		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	   	})();
	   	$(document).on('click', '[data-ga-label]', function() {
	   		_gaq.push(['_trackEvent', 'Call To Action', 'Click', $(this).attr('data-ga-label')]);
	   	});
	</script>
</head>
<body id="blog">
		<div id="top"></div>
		<img class="hidden" src="/img/miguel-mota-m-logo-500x500.png" alt="">

		<header id="header" class="contain-to-grid fixed">
			<nav class="top-bar">
				<ul class="title-area">
					<li class="name"><a href="/" data-ga-label="Navigation - Logo">Miguel Mota</a></li>
					<li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
				</ul>
				<section class="top-bar-section">
				    <ul id="main-nav" class="right">
				      <li class="divider"></li>
				      <li ><a href="/" data-ga-label="Navigation - Home"><i class="icon-home"></i></a></li>
				      <li class="divider"></li>
				      <li ><a href="/about" data-ga-label="Navigation - About"><i class="icon-bookmark-empty"></i> About</a></li>
				      <li class="divider"></li>
				      <li class="active"><a href="/blog" data-ga-label="Navigation - Blog"><i class="icon-lightbulb"></i> Thoughts</a></li>
				      <li class="divider"></li>
				      <li ><a href="/work" data-ga-label="Navigation - Work"><i class="icon-laptop"></i> Work</a></li>
				      <li class="divider"></li>
							<li ><a href="/contact" data-ga-label="Navigation - Contact"><i class="icon-envelope"></i> Contact</a></li>
				      <li class="divider"></li>
				    </ul>
				</section>
			</nav>
		</header>

		<main id="main" role="main">
			<header id="content-header">
	<canvas id="canvas"></canvas>
	<div class="row">
		<div class="large-12 column">

			<datetime>14 Mar 2014 <small><i class="icon-comment-alt"></i> <a href="/blog/deployment-with-git#disqus_thread" data-disqus-identifier="/blog/deployment-with-git"></a></small> <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://www.miguelmota.com/blog/deployment-with-git" data-text="Deployment with Git" data-size="large" data-related="_moogs" data-ga-label="Blog post - Tweet">Tweet</a></datetime>
			<h1>Deployment with Git</h1>

		</div>
	</div>
	<div id="content-header-bottom">
		<div class="triangle"></div>
	</div>
</header>

<section id="post">
	<div class="row">
		<div class="large-12 column">

			<p>A <a href="http://git-scm.com/docs/githooks.html">Git hook</a> allows you to execute custom scripts when an action occurs, such as when a commit or push is performed. Before I discovered git hooks, my deployment process consisted of pushing changes to my remote repository, SSH’ing into the server, navigating to the site directory, pulling the changes, and restarting the webserver. It wasn’t efficient at all and a waste of time doing that several times a day. I’ll explain how to set up a simple git hook making the deployment process a bit more effortless, but first I want to give credit to this <a href="http://toroid.org/ams/git-website-howto">how-to</a> article which got me started.</p>

<p>In this example we’ll be deploying the <em>production</em> branch but it can be whatever branch name you want, and our site name will be called <em>foo</em>.</p>

<h2 id="on_the_server">On the server</h2>

<p>Initialize an empty git repo.</p>
<div class='highlight'><pre><code class='bash'>mkdir -p /opt/git/foo.git
<span class='nb'>cd</span> /opt/git/tracfone.git
git init --bare <span class='c'># no source files, only version control</span>
</code></pre></div>
<p>Create a <a href="http://git-scm.com/book/en/Customizing-Git-Git-Hooks"><code>post-receive</code></a> hook which gets called after a <em>push</em> is complete.</p>
<div class='highlight'><pre><code class='bash'>vim /opt/git/foo.git/hooks/post-receive
</code></pre></div><script src='https://gist.github.com/miguelmota/9595095.js'><![CDATA[]]></script>
<p>(<a href="https://gist.github.com/miguelmota/9595095">hook gist</a>)</p>

<p>Make sure to make the hook executable.</p>
<div class='highlight'><pre><code class='bash'>chmod u+rwx /opts/git/foo.git/hooks/post-receive
</code></pre></div>
<h2 id="on_the_client">On the client</h2>

<p>Add the remote url.</p>
<div class='highlight'><pre><code class='bash'>git remote add production ssh://&lt;username@&lt;server ip&gt;/opt/git/foo.git
</code></pre></div>
<p>Push the <em>production</em> branch.</p>
<div class='highlight'><pre><code class='bash'>git push production +production:refs/heads/production

<span class='c'># Afterwards you can simply do</span>
git push production
</code></pre></div>
<p>It’s also possible to deploy to multiple servers, just add the remote urls in <code>.git/config</code>.</p>
<div class='highlight'><pre><code class='bash'><span class='o'>[</span>remote <span class='s2'>&quot;production&quot;</span><span class='o'>]</span>
  <span class='nv'>url</span> <span class='o'>=</span> ssh://&lt;username&gt;@&lt;server 1 ip&gt;/opt/git/foo.git
  <span class='nv'>url</span> <span class='o'>=</span> ssh://&lt;username&gt;@&lt;server 2 ip&gt;/opt/git/foo.git
</code></pre></div>
<p>By default git will push all branches to the remotes but we can have it push the current branch only.</p>
<div class='highlight'><pre><code class='bash'>git config --global push.default current
</code></pre></div>
<h2 id="conclusion">Conclusion</h2>

<p>Git hooks can help automate your deployment process. Checkout the list of client and server-side <a href="http://git-scm.com/book/en/Customizing-Git-Git-Hooks">Git hooks</a> available.</p>

			<div class="tags">
				<i class="icon-tag"></i>
				
					<a href="/tag/Git">Git</a> <span>+</span>
				
					<a href="/tag/SSH">SSH</a> <span>+</span>
				
					<a href="/tag/deployment">deployment</a> <span>+</span>
				
			</div>

		</div>
	</div>

	
		<div id="related-posts" class="row">
			<div class="row">
				<div class="large-12 column">
					<div class="input-short-url">share: <input type="text" value="http://mig.gs/gUva"></div>
				</div>
			</div>
			<div class="large-6 column">
				
    

    <h3>Previous post</h3>

	    <dl class="posts-list">

				<dt><datetime>23 Jan 2014</datetime></dt>
				<dd><h2><a href="/blog/intro-to-redis">Intro to Redis</a> <small><i class="icon-comment-alt"></i> <a href="/blog/intro-to-redis#disqus_thread" data-disqus-identifier="/blog/intro-to-redis"></a></small></h2></dd>

			</dl>

    



			</div>
			<div class="large-6 column">

				<h3>See also...</h3>

				<dl class="posts-list">
					
						<dt><datetime>23 Jan 2014</datetime></dt>
<dd><h2><a href="/blog/intro-to-redis">Intro to Redis</a> <small><i class="icon-comment-alt"></i> <a href="/blog/intro-to-redis#disqus_thread" data-disqus-identifier="/blog/intro-to-redis"></a></small></h2>
</dd>
					
						<dt><datetime>30 Nov 2013</datetime></dt>
<dd><h2><a href="/blog/getting-started-with-backbonejs">Getting Started with Backbone.js</a> <small><i class="icon-comment-alt"></i> <a href="/blog/getting-started-with-backbonejs#disqus_thread" data-disqus-identifier="/blog/getting-started-with-backbonejs"></a></small></h2>
</dd>
					
						<dt><datetime>30 Oct 2013</datetime></dt>
<dd><h2><a href="/blog/memoization-caching-function-results-in-javascript">Memoization&#58; Caching function results in JavaScript</a> <small><i class="icon-comment-alt"></i> <a href="/blog/memoization-caching-function-results-in-javascript#disqus_thread" data-disqus-identifier="/blog/memoization-caching-function-results-in-javascript"></a></small></h2>
</dd>
					
						<dt><datetime>30 Sep 2013</datetime></dt>
<dd><h2><a href="/blog/set-up-ssh-keys">Set up SSH keys</a> <small><i class="icon-comment-alt"></i> <a href="/blog/set-up-ssh-keys#disqus_thread" data-disqus-identifier="/blog/set-up-ssh-keys"></a></small></h2>
</dd>
					
						<dt><datetime>26 Sep 2013</datetime></dt>
<dd><h2><a href="/blog/nodejs-and-nginx-on-ubuntu">Node.js and Nginx on Ubuntu</a> <small><i class="icon-comment-alt"></i> <a href="/blog/nodejs-and-nginx-on-ubuntu#disqus_thread" data-disqus-identifier="/blog/nodejs-and-nginx-on-ubuntu"></a></small></h2>
</dd>
					
				</dl>

			</div>
		</div>
	

	<div id="comments" class="row">
		<div class="large-12 column">
			<div id="disqus_thread"></div>
		</div>
	</div>

</section>

<script>
    var disqus_shortname = 'miguelmota';
    var disqus_identifier = '/blog/deployment-with-git';
    var disqus_url = 'http://www.miguelmota.com/blog/deployment-with-git';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

		</main>

		<footer id="footer">
			<div class="row">
				<div class="large-12 column">
					<p>
						<span class="break"><span>© 2014 Moogs™, LLC.</span> <span>Made with <i class="icon-heart"></i></span></span> <a class="hidden" href="https://plus.google.com/102174577273194387652" rel="author">Google+</a>

						<a href="https://twitter.com/_moogs" class="twitter-follow-button" data-show-count="false" data-size="large" data-ga-label="Footer - Follow Twitter">Follow @_moogs</a>

					</p>
				</div>
			</div>
		</footer>

		<a id="forkme" href="https://github.com/miguelmota/miguelmota.github.com" target="_blank" data-ga-label="Fork me on Github"><img src="/img/forkme_right_darkblue_121621.png" alt=""></a>

		<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
		<script src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/src/infobox.js"></script>
	</body>
</html>
